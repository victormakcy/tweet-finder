var TweetFinder=angular.module("tweetFinderApp",[]);TweetFinder.controller("TweetFinderController",["$scope","tweetsService",function($scope,tweetsService){$scope.loadingNewTweets=!1,$scope.loadingMoreTweets=!1,$scope.tweets=[],$scope.getTweets=function(){$scope.loadingNewTweets=!0,tweetsService.getTweets($scope.keywords,21,null).then(function(result){$scope.loadingNewTweets=!1,$scope.tweets=result},function(){})},$scope.getMoreTweets=function(){var lastItem=$scope.tweets[$scope.tweets.length-1];$scope.loadingMoreTweets=!0,tweetsService.getTweets($scope.keywords,22,lastItem.id).then(function(result){result.length&&(result.splice(0,1),$scope.tweets=$scope.tweets.concat(result),$scope.loadingMoreTweets=!1)},function(){})}}]),TweetFinder.factory("tweetsService",["$http",function($http){var transformTweets=function(tweets){var transformedTweets=[];return tweets.forEach(function(tweet){var index=tweet.created_at.indexOf("+"),date=tweet.created_at.substr(0,index-1);transformedTweets.push({id:tweet.id,userProfileImageURL:tweet.user.profile_image_url.replace("normal","bigger"),userScreenName:"@"+tweet.user.screen_name,userProfileURL:"https://www.twitter.com/"+tweet.user.screen_name,message:tweet.text,date:date})}),transformedTweets};return{getTweets:function(keywords,count,maxId){return $http({method:"GET",url:"/api/tweets?q="+encodeURIComponent(keywords)+"&count="+count+"&max_id="+maxId}).then(function(res){return transformTweets(res.data)},function(err){})}}}]),TweetFinder.directive("tweetDirective",function(){return{restrict:"E",templateUrl:"app/shared/tweet/tweetView.html"}});